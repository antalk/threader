<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:t="http://tapestry.apache.org/schema/tapestry_5_3.xsd"
      xmlns:p="tapestry:parameter">
      
      <t:if test="folderSelected">
      	<t:ProgressiveDisplay/>
      	<p:else>
      		Select a working folder
      	</p:else>
      </t:if>
      
      <t:block t:id="messageblock">
      	<div class="panel">
      		<div class="panel-heading bg-primary">
      			<div class="pull-left">
		      		<div class="btn-group">
		      			<t:eventlink t:event="reloadmessages" t:zone="^">
							<button class="btn btn-default" title="Reload messages from server"><span class="glyphicon glyphicon-refresh" ></span></button>
						</t:eventlink>
						<t:eventlink t:event="deletemessages" t:zone="^">
							<button class="btn btn-default" title="delete_message"><span class="glyphicon glyphicon-trash" ></span></button>
						</t:eventlink>
		      		</div>
		      	</div>
		      	<div class="clearfix"/>
		     </div>
		     <div class="panel-body">
		     	  <t:grid t:id="messageGrid" source="messageSource" include="prop:columns" add="check,address" reorder="check,address" row="message" zone="messageZone" class="table table-hover" >  
				  	<p:checkHeader>
				  		<span class="glyphicon glyphicon-check" ></span>
				  	</p:checkHeader>
				  	<p:addressHeader>
				  		${headerAddress}
				  	</p:addressHeader>
				  	
				  	<p:checkCell>
				  		<t:form>
				  			<t:ck.ajaxcheckbox t:id="msgchecked" t:context="message.UID"/>
				  		</t:form> 
				  	</p:checkCell>
				  	<p:addressCell>
				  		<!--  either from or to address here -->
				  		${fromortoAddress}<br/>
				  		<t:if test="isOutGoing">
					  		<t:tapisser.Modal t:event="composeMessage" t:context="message.uid" large="true">${subject}</t:tapisser.Modal>
				  			<p:else>
				  				<t:eventlink t:event="fetchMessageContent" t:zone="^" t:context="message.UID">
						  			<t:if test="messageRead">
						  				${subject}
						  				<p:else>
						  					<b>${subject}</b>
						  				</p:else>
						  			</t:if>
						  		</t:eventlink>
				  			</p:else>
				  		</t:if>
				  		
				  	</p:addressCell>
				  	<p:sentDateCell>
				  		${messageDate}
				  	</p:sentDateCell>
				</t:grid>
			</div>
		</div>
	  </t:block>
</html>
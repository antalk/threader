<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:t="http://tapestry.apache.org/schema/tapestry_5_3.xsd"
      xmlns:p="tapestry:parameter">
      
      <t:if test="folderSelected">
      	<t:ProgressiveDisplay initial="prop:ajaxLoader" update="show"/>
      	<p:else>
      		<div class="well">Select a working folder</div>
      	</p:else>
      </t:if>
      
      <t:block t:id="messageblock">
      	<div class="panel">
      		<div class="panel-heading bg-primary">
      			<div class="pull-left">
		      		<div class="btn-group">
		      			<t:eventlink t:event="reloadmessages" t:zone="^">
							<button class="btn btn-default" title="Reload messages from server"><span class="glyphicon glyphicon-refresh" ></span></button>
						</t:eventlink>
						<t:eventlink t:event="deletemessages" t:zone="^">
							<button class="btn btn-default" title="delete_message"><span class="glyphicon glyphicon-trash" ></span></button>
						</t:eventlink>
		      		</div>
		      	</div>
		      	<div class="clearfix"/>
		     </div>
		     <div class="panel-body">
		     	  <t:grid t:id="messageGrid" source="messageSource" include="literal:uid" add="address,date" reorder="uid,address" row="message" zone="messageZone" pagerPosition="bottom" rowsPerPage="5" inplace="true"	class="table table-hover" >  
				  	<p:uidHeader>
				  		<span class="glyphicon glyphicon-check" ></span>
				  	</p:uidHeader>
				  	<p:addressHeader>
				  		${headerAddress}
				  	</p:addressHeader>
				  	
				  	<p:uidCell>
				  		<t:form>
				  			<t:ck.ajaxcheckbox t:id="msgchecked" t:context="message.id"/>
				  		</t:form> 
				  	</p:uidCell>
				  	<p:addressCell>
				  		<!--  either from or to address here -->
				  		${fromortoAddress}<br/>
				  		<t:if test="isOutGoing">
					  		<t:tapisser.Modal t:event="composeMessage" t:context="message.uid" large="true">${subject}</t:tapisser.Modal>
				  			<p:else>
				  				<t:eventlink t:event="fetchMessageContent" t:zone="^" t:context="message.id">
						  			<t:if test="messageRead">
						  				${subject}
						  				<p:else>
						  					<b>${subject}</b>
						  				</p:else>
						  			</t:if>
						  		</t:eventlink>
				  			</p:else>
				  		</t:if>
				  		
				  	</p:addressCell>
				  	<p:dateCell>
				  		${messageDate}
				  	</p:dateCell>
				</t:grid>
			</div>
		</div>
	  </t:block>
</html>